<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook V4.1//EN">
<book>
<bookinfo>
	<title><inlinegraphic fileref="netmrg-logo-medium.png">The NetMRG Reference</title>
	<authorgroup>
		<author>
			<firstname>Brady</firstname>
			<surname>Alleman</surname>
		</author>
		<author>
			<firstname>Douglas</firstname>
			<othername>E.</othername>
			<surname>Warner</surname>
		</author>
	</authorgroup>
	<pubdate>2004</pubdate>
	<copyright>
		<year>2003-2004</year>
		<holder>Brady Alleman and Douglas E. Warner</holder>
	</copyright>

	<legalnotice id="license">
		<para>This project is licensed under the terms of the MIT License.</para>
		<para>
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:
		</para>
		<para>
The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.
		</para>
		<para>
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
		</para>
		<para>
All product names are property of their respective owners.  Such names are used
for identification purposes only and are not indicative of endorsement by or of
any company, organization, product, or platform.
		</para>
	</legalnotice>
</bookinfo>

<part id="overview">
<title>Overview</title>
<chapter id="intro">
	<title>Introduction</title>
	<para>Welcome to NetMRG!  NetMRG is a database-driven network monitoring and graphing tool for use on Linux systems.  It offers an intuitive web-based configuration, customized monitoring capabilities for unusual situations, a fast multi-threaded polling application, and brilliant graphs rendered by <ulink url="http://www.rrdtool.org/"><Application>RRDTOOL</Application></ulink>.</para>
	<para>This document aims to guide you swiftly through the installation and configuration of NetMRG, as well as act as a reference for those with existing installations.</para>
</chapter>
<chapter id="revisions">
	<title>Revision History</title>
	<itemizedlist>
		<listitem>
			<para>0.16</para>
			<para>2004.06.10</para>
			<para>
Minor Bugfixes and Feature Enhancements;
fixed a user management bug and several bugs related to 'single view only' 
users not being able to see graphs, added the ability to ignore SNMP uptime checks 
for devices (permitting the monitoring of broken devices), added the ability 
to do an SNMP walk of an OID (useful for the Windows SNMP agent), 
enhanced group/device management, cleaned up autoconf (now supports FC2),
and added experimental syslog and daemon support in the gatherer.
			</para>
		</listitem>
		<listitem>
			<para>0.15</para>
			<para>2004.05.20</para>
			<para>
Minor Bugfixes and Feature Enhancements; fixes for various db errors (including the infamous one on 
snmp_cache_view.php), better cross-platform compilation, select all/none/invert checkbox support, support for 
choosing what graph to apply to an interface, better support for php < 4.2.0, and some security fixes for 
single-view-only users.
			</para>
		</listitem>
		<listitem>
			<para>0.14</para>
			<para>2004.03.10</para>
			<para>
Minor Bugfixes and Feature Enhancements; escaping issues in template dereferencing, broken links on 
various pages, security issues regarding manual SNMP recaching, broken duplication on non-cutting-edge MySQL,
more parameter substitution in SQL tests, better date parsing for advanced graph view, nav-bar and group navigation
enhancements, advanced view capability for monitor-only graphs.
			</para>
		</listitem>
		<listitem>
			<para>0.13</para>
			<para>2003.12.19</para>
			<para>
Minor Bugfixes and Feature Enhancements; slide show ordering, previous slide, resume slide show,
better formatting of 'sums', errors on view editing, fixes to permissions checking, and an 
occassional segfault in the gatherer was fixed.
			</para>
		</listitem>
		<listitem>
			<para>0.12</para>
			<para>2003.12.15</para>
			<para>
Major Feature Enhancents and Bugfixes; added SNMPv2 support, fixed a bug that
would cause a device to be deleted from all groups, fixed session timeout
when using external auth, added checkbox support to interface/disk cache pages, slide show
enhancements, fixed permission issue where unauthorized users could view/edit test_* pages
			</para>
		</listitem>
		<listitem>
			<para>0.10</para>
			<para>2003.10.05</para>
			<para>
Major bug fix; fixes a db error when trying to view monitors, a bug that would
always set the width and height to zero when creating graphs, and makes conditions
with 'rate of change' work.  Many documentation upgrades.
			</para>
		</listitem>
		<listitem>
			<para>0.10pre2</para>
			<para>2003.09.15</para>
			<para>
This release focuses on adding new features and sqaushing bugs.  In addition,
there is now an 'updater.php' that is required to be run between versions.  A
minor change needs to be made to everyone's 'netmrg.xml' to add an 'externalauth'
field inside the 'website' section.
			</para>
		</listitem>
		<listitem>
			<para>0.10pre1</para>
			<para>2003.07.28</para>
			<para>Initial publication</para>
		</listitem>
	</itemizedlist>
</chapter>
</part>

<part id="concepts">
<title>Concepts</title>
<chapter id="sytemstruct">
	<title>System Structure</title>
	<para>The components of NetMRG.
		<itemizedlist>
			<listitem><para>Gatherer</para><para>The Gatherer is a multi-threaded C++ program that interacts with the Database and RRDTOOL to gather and store data.  The program is run by cron, or another scheduling system of your choice, on five minute intervals.</para></listitem>
			<listitem><para>Web Interface</para><para>The Web Interface consists of several PHP scripts, static HTML files and images, as well as CSS for formatting.  It interacts with the Database for the storage of configuration data and with RRDTOOL for the rendering of graphs for presentation.</para></listitem>
			<listitem><para>Database</para><para>The Database is a relational database running on <ulink url="http://www.mysql.com/"><application>MySQL</application></ulink>.  It is utilized by the Web Interface and the Gatherer.</para></listitem>
			<listitem><para>RRDTOOL</para><para><ulink url="http://www.rrdtool.org/"><application>RRDTOOL</application></ulink> is a graphing system based upon round-robin databases (RRDs).  It is used for both storing data into the databases and creating graphs using the databases.</para></listitem>
			<listitem><para>RRDs</para><para>RRDs are the round-robin databases used by RRDTOOL.  They are individual files that are writable by the Gatherer and readable by the Web Interface.</para></listitem>
		</itemizedlist>
	</para> 
</chapter>
<chapter id="monitorconcepts">
	<title>Monitoring and Reporting Concepts</title>
	<itemizedlist>
		<listitem>
			<para>Groups</para>
			<para>
Groups are organizational containers used in NetMRG.  They are capable of 
containing Devices, as well as having a View associated with them.  As they 
are strictly organizational, the Web Interface is the only component to 
utilize them.  They are ignored by the Gatherer.
			</para>
		</listitem>
		<listitem>
			<para>Devices</para>
			<para>
Devices can be thought of as any physical device on your network that will 
be monitored.  They may also be used organizationally to group Monitors 
that are not associated directly to any physcial host.  Devices may have, 
but are not required to have, IP addresses, SNMP community strings, and so 
forth.  Data gathering for Devices may be explicitly disabled.  Devices 
contain Sub-Devices.
			</para>
		</listitem>
		<listitem>
			<para>Sub-Devices</para>
			<para>
Sub-Devices are discrete entities on a Device.  Examples of these are network 
interfaces, disk drives, and so forth.  Sub-Devices may have parameters or 
variables associated with them for identification purposes.  For example, a 
web server has a network interface designated "eth0."  In NetMRG, the server 
would have a network interface Sub-Device which would have a variable of 
"ifDescr" set to "eth0."  Sub-Devices contain Monitors.
			</para>
		</listitem>
		<listitem>
			<para>Monitors</para>
			<para>
Monitors represent discrete monitorable quantities.  The Gatherer performs the 
Monitor's Test upon the Monitor's Sub-Device.  The result is then stored in a 
RRD.  Monitors are also associated with Graph Items.  If NetMRG is being used 
to track events, a Monitor may also contain Events.
			</para>
		</listitem>
		<listitem>
			<para>Tests</para>
			<para>
Tests are data gathering operations associated with Monitors.  There are four 
types of tests:  Scripts, SNMP Queries, SQL Queries, and Internal tests.  
Script tests call a script and use either its return code or its output as 
data.  SNMP Tests perform a SNMP GET operation against a device using a 
supplied OID.  SQL Tests perform a MySQL query and use a value from a returned 
row as data.  Internal tests are frequently used tests built into the Gatherer.  
They typically start as Script Tests but are integrated for the sake of 
efficiency.
			</para>
		</listitem>
		<listitem>
			<para>Events</para>
			<para>
Events contain a group of Conditions and Responses.  If the Conditions of an 
Event are met, the appropriate response is performed.
			</para>
		</listitem>
	</itemizedlist>
</chapter>
<chapter id="graphconcepts">
	<title>Graphing Concepts</title>
	<itemizedlist>
		<listitem><para>Graphs</para><para>Graphs are the abstraction of a single chart generated by NetMRG using <ulink url="http://www.rrdtool.org/"><application>RRDTOOL</application></ulink>.  Graphs have properties such as sizes, a title, and vertical labels.  They also contain a set of Graph Items which represent the separate pieces of data graphed.</para><itemizedlist><listitem><para>Custom Graphs</para><para>Custom graphs have "absolute" referencing of data to be displayed.  They are typically used for graphs that are applicable in only one instance, such as a stack graph of all Internet links on your network.</para></listitem><listitem><para>Templated Graphs</para><para>Template Graphs have "relative" references to data.  They are used for graphs such as CPU load on a server or traffic on a network interface.  They are applicable in many instances.  The use of templates allows you to create one graph for a set of variables on a Sub-Device and then apply that same graph to other Sub-Devices for graphs formatted identically.  This allows considerable savings of time as there is no need to create a Custom Graph for each instance of a graph.</para></listitem></itemizedlist></listitem>
		<listitem><para>Graph Items</para><para>Graph Items represent data on a graph.  They can represent areas, lines, and stacks on Graphs.  Each Graph Item is linked to a Monitor for dynamic data or given a static value.  Options for Graph Items include type (such as line, area, stack), color, value (either static or dynamic based on a Monitor), and legend options.</para></listitem>
	</itemizedlist>
</chapter>
</part>

<part id="installation">
<title>Installation</title>
<chapter id="softwarereq">
	<title>Software Requirements</title>
	<para>NetMRG Requires the following packages for compilation.</para>
	<itemizedlist>
		<listitem><para><ulink url="http://www.php.net/"><application>PHP</application></ulink>, Version >= 4.1</para></listitem>
		<listitem><para><ulink url="http://www.mysql.com/"><application>MySQL</application></ulink>, Version >= 3.23</para></listitem>
		<listitem><para><ulink url="http://www.rrdtool.org/"><application>RRDTOOL</application></ulink>, Version >= 1.0.28</para></listitem>
		<listitem><para><ulink url="http://xmlsoft.org/"><application>Libxml2</application></ulink>, Version >= 2.30</para></listitem>
		<listitem><para><ulink url="http://gcc.gnu.org/libstdc++/"><application>Libstdc++</application></ulink>, Version >= 3.2</para><para>Versions earlier than this may compile just fine, but may experience runtime issues.  Specifically, we experienced software crashes on an SMP machine running version 2.96 that were resolved by upgrading to 3.2.</para></listitem>
		<listitem><para><ulink url="http://net-snmp.sf.net/"><application>NET/UCD-SNMP</application></ulink>, Version >= 4.2.2</para></listitem>
	</itemizedlist>
</chapter>
<chapter id="satisfyreq">
	<title>Satisfying Requirements</title>
	<para>Specific instructions to satisfy dependencies for certain platforms are presented below.  They should be used more as suggestions, not necessarily step-by-step instructions.  You may need to do more than what is listed, or much less, depending on the options you selected when installing your operating system.</para>
	<itemizedlist>
		<listitem>
			<para><ulink url="http://www.redhat.com/"><application>Red Hat Linux</application></ulink></para>
			<itemizedlist>
				<listitem><para>In order to satisfy the libstdc++ requirement, Redhat 8.0 or above is required.  NetMRG may not be stable on older versions of libstdc++.</para></listitem>
				<listitem>
					<para>Install the following RPMs from your Red Hat installation media:</para>
					<itemizedlist>
						<listitem><para><filename>httpd</filename></para></listitem>
						<listitem><para><filename>php</filename></para></listitem>
						<listitem><para><filename>php-mysql</filename></para></listitem>
						<listitem><para><filename>mysql</filename></para></listitem>
						<listitem><para><filename>mysql-server</filename></para></listitem>
						<listitem><para><filename>mysql-devel</filename></para></listitem>
						<listitem><para><filename>libxml2</filename></para></listitem>
						<listitem><para><filename>libxml2-devel</filename></para></listitem>
						<listitem><para><filename>net-snmp</filename></para></listitem>
						<listitem><para><filename>net-snmp-devel</filename></para></listitem>
						<listitem><para><filename>net-snmp-utils</filename></para></listitem>
					</itemizedlist>
				</listitem>
				<listitem>
					<para>Installing <application>RRDTOOL</application></para>
					<itemizedlist>
						<listitem><para>Download an <application>RRDTOOL</application> RPM from <ulink url="http://www.freshrpms.net/">http://www.freshrpms.net/</ulink></para></listitem>
						<listitem><para>OR Download the <application>RRDTOOL</application> source from <ulink url="http://www.rrdtool.org/">http://www.rrdtool.org/</ulink> and compile it.</para></listitem>
					</itemizedlist>
				</listitem>
				<listitem>
					<para>Installing precompiled NetMRG RPM</para>
					<para>Download the latest NetMRG RPM and install it as follows:</para>
					<programlisting>rpm -Uvh netmrg-0.10.rpm</programlisting>
					<para>You will still have to perform the following tasks listed in the Install Instructions:</para>
					<itemizedlist>
						<listitem><para>Setup the Database</para></listitem>
						<listitem><para>Configure Apache</para></listitem>
						<listitem><para>Configure the Installation</para></listitem>
						<listitem><para>Setup Crontab</para></listitem>
					</itemizedlist>
				</listitem>
			</itemizedlist>
		</listitem>
		<listitem>
			<para><ulink url="http://www.freebsd.org/"><application>FreeBSD (4.8)</application></ulink></para>
			<itemizedlist>
				<listitem>
				<para>Install the following ports:</para>
				<itemizedlist>
					<listitem><para><filename>www/apache13</filename></para></listitem>
					<listitem><para><filename>rrdtool</filename></para></listitem>
					<listitem><para><filename>net-snmp</filename></para></listitem>
					<listitem><para><filename>libxml2</filename></para></listitem>
					<listitem><para><filename>mod_php4</filename> (specify MySQL support)</para></listitem>
					<listitem><para><filename>lang/gcc32</filename></para></listitem>
				</itemizedlist>
				</listitem>
				<listitem>
				<para>Run <command>configure</command>, specifying gcc32:</para>
				<programlisting>./configure 'LDFLAGS=-L/usr/local/gcc3/lib' 'CPPFLAGS=-I/usr/local/gcc3/include' 'CXX=g++32'</programlisting>
				</listitem>
			</itemizedlist>
		</listitem>
	</itemizedlist>
</chapter>
<chapter id="install">
	<title>Installation Procedure</title>
	<orderedlist>
		<listitem>
			<para>Untar to some directory like /tmp/ (it will untar into a 'netmrg' directory)</para>
<programlisting>cd /tmp
wget http://www.netmrg.net/download/release/netmrg.tar.gz
tar xzvf netmrg.tar.gz</programlisting>
		</listitem>
		<listitem>
			<para>
Now we need to compile and install the source. <command>cd</command> into the directory 
made by your <command>tar</command> command and type the following:
			</para>
<programlisting>./configure
make
make install</programlisting>
			<note><para>If <command>configure</command> fails to locate the needed libraries they can be manually specified.  Run <command>./configure --help</command> for details on the necessary options.</para></note>
		</listitem>
		<listitem>
			<para>Setup the database</para>
			<para>
Now we need to setup the database.  Please change at least the password 
(<computeroutput>netmrgpass</computeroutput> below).
			</para>
<programlisting>mysqladmin create netmrg
mysql -u root -p netmrg < share/netmrg.mysql
mysql -u root -p
> grant all on netmrg.* to netmrguser@localhost identified by 'netmrgpass';</programlisting>
		</listitem>
		<listitem>
			<para>
You need to modify your apache config in order to make your NetMRG installation 
live (commonly in <computeroutput>/etc/httpd/conf/httpd.conf</computeroutput>).
			</para>
			<para>
The first is to alias /netmrg to the installed web directory (commonly 
<computeroutput>/usr/local/var/www/netmrg/webfiles</computeroutput>).
			</para>
<programlisting>Alias /netmrg "/usr/local/var/www/netmrg/webfiles"</programlisting>
			<para>
The easier way (if you're running Apache >= 1.3) is to just Include the conf 
file we've created anywhere in your file (near the bottom is fine).
			</para>
<programlisting>Include /usr/local/etc/netmrg.conf</programlisting>
			<para>
You will need to restart your Apache after making config changes.  Telling it 
to reload its config should be good enough
			</para>
<programlisting>killall -HUP httpd</programlisting>
		</listitem>
		<listitem>
			<para>Configure the Installation</para>
			<para>
All of NetMRG's common configuration options are controlled by an XML file,
normally located at <filename>/usr/local/etc/netmrg.xml</filename>.  You should
edit this file to make any necessary changes before continuing with installation.
			</para>
			<para>
For most installations, you will at least need to edit <filename>netmrg.xml</filename>
to reflect your database username and password.  
			</para>
		</listitem>
		<listitem>
			<para>Setup Permissions</para>
			<para>
NetMRG does not need superuser permissions to run, therefore we will setup a user for it.
			</para>
<programlisting># useradd netmrg
# chown netmrg:netmrg /usr/local/var/log/netmrg
# chown netmrg:netmrg /usr/local/var/lib/netmrg/rrd</programlisting>
		</listitem>
		<listitem>
			<para>Setup crontab</para>
			<para>
You can setup the crontab entries in two places: either edit <filename>/etc/crontab</filename>,
or run <command>crontab -e</command> as the netmrg user. For 'crontab -e', use an 
entry similar to this:
			</para>
<programlisting>su netmrg
*/5 * * * * /usr/local/bin/netmrg_cron.sh
exit</programlisting>
			<para>
To edit the master crontab, edit <filename>/etc/crontab</filename> and add a line 
similar to this:
			</para>
<programlisting>*/5 * * * * netmrg /usr/local/bin/netmrg_cron.sh</programlisting>
		</listitem>
		<listitem>
			<para>
Point your web browser at your install, and start graphing things!  The default 
login is <userinput>admin</userinput> and the default password is 
<userinput>nimda</userinput>.  Point your web browser at the host you built 
this on (something similar to <computeroutput>http://yourhost.com/netmrg/</computeroutput>) 
and please change your password!
			</para>
		</listitem>
	</orderedlist>
</chapter>
<chapter id="upgrade">
	<title>Upgrade Procedure</title>
	<para>
After doing a 'make install' as described in the chapter on Installing NetMRG, 
the next step is to run the web-based upgrader.  This is accomplished by logging
into NetMRG with administrator privileges, and following the prompts.  NetMRG's
web interface will not operate normally until the web-based upgrade is performed,
and non-administrator users will only receive a message directing them to contact
their NetMRG administrator.
	</para>
</chapter>
<chapter id="tutorial">
	<title>NetMRG Tutorial</title>
	<para>This brief tutorial will walk you through the major features of NetMRG.  The tutorial assumes that you have installed the <ulink url="http://net-snmp.sf.net/"><application>Net-SNMP</application></ulink> daemon on a system which you want to monitor.</para>
	<orderedlist>
		<listitem>
			<para>Create a new group.</para>
			<orderedlist>
				<listitem>
					<para>Click on <guilabel>Groups</guilabel> in the <guilabel>Monitoring</guilabel> menu.</para>
				</listitem>
				<listitem>
					<para>Click on <guilabel>Add</guilabel>.</para>
				</listitem>
				<listitem>
					<para>In the <guilabel>Name</guilabel> textbox, enter a name for your group, such as "Home."</para>
				</listitem>
				<listitem>
					<para>In the <guilabel>Comment</guilabel> textbox, enter a description for your group, such as "Computers in my house."</para>
				</listitem>
				<listitem>
					<para>In the <guilabel>Parent</guilabel> drop down box, select <computeroutput>-Root-</computeroutput> as we want this device in the root of the device tree.  You can create nested groups.</para>
				</listitem>
				<listitem>
					<para>Click the <guilabel>Save Changes</guilabel> button to create your new group.</para>
				</listitem>
			</orderedlist>
		</listitem>
		<listitem>
			<para>Create a new device.</para>
			<orderedlist>
				<listitem>
					<para>Click on the name of your new group.  You are now looking at an (empty) list of devices in your new group.</para>
				</listitem>
				<listitem>
					<para>Click on <guilabel>Add</guilabel> in the Monitored Devices section.</para>
				</listitem>
				<listitem>
					<para>Click on <guilabel>Create a new device</guilabel>.</para>
				</listitem>
				<listitem>
					<para>In the <guilabel>Name</guilabel> textbox, enter a name for your device, such as "My Server."</para>
				</listitem>
				<listitem>
					<para>In the <guilabel>IP or Host Name</guilabel> textbox, enter a domain name or IP address of your device.  Domain names must be resolvable from your monitoring host.</para>
				</listitem>
				<listitem>
					<para>In the <guilabel>SNMP Support</guilabel> dropdown, select the appropriate version.  If unsure, select <guilabel>SNMPv1</guilabel>.</para>
				</listitem>
				<listitem>
					<para>In the <guilabel>SNMP Read Community</guilabel> textbox, enter the SNMP community string for your device.</para>
				</listitem>
				<listitem>
					<para>Click the <guilabel>Save Changes</guilabel> button to create your new device.</para>
				</listitem>
			</orderedlist>
		</listitem>
		<listitem>
			<para>Create a new sub-device.</para>
			<orderedlist>
				<listitem>
					<para>Click on the name of your new device.  You are now looking at an (empty) list of sub-devices in your new device.</para>
				</listitem>
				<listitem>
					<para>Click on <guilabel>Add</guilabel>.</para>
				</listitem>
				<listitem>
					<para>In the <guilabel>Name</guilabel> textbox, enter "System."  This will be a pseudo-sub-device used for monitoring the device as a whole.</para>
				</listitem>
				<listitem>
					<para>In the <guilabel>Type</guilabel> drop down box, ensure that <computeroutput>Group</computeroutput> is selected.</para>
				</listitem>
				<listitem>
					<para>Click the <guilabel>Save Changes</guilabel> button to create your new "System" sub-device.</para>
				</listitem>
			</orderedlist>
		</listitem>
		<listitem>
			<para>Add graph templates.</para>
			<para>Since devices running <application>Net-SNMP</application> are common, NetMRG comes with several graph templates for commonly used variables.</para>
			<orderedlist>
				<listitem>
					<para>Click on <guilabel>Template Graphs</guilabel> in the <guilabel>Graphing</guilabel> menu.</para>
				</listitem>
				<listitem>
					<para>Click on the <guilabel>Apply Template To...</guilabel> next to the <computeroutput>Linux Box - CPU Utilization</computeroutput> template graph.</para>
				</listitem>
				<listitem>
					<para>In the <guilabel>Subdevice</guilabel> drop down box, select <computeroutput>My Server - System</computeroutput>.</para>
				</listitem>
				<listitem>
					<para>Click on the <guilabel>Save Changes</guilabel> button to apply the template.</para>
				</listitem>
				<listitem>
					<para>Repeat this step for any other graph templates you find interesting.</para>
				</listitem>
			</orderedlist>
		</listitem>
		<listitem>
			<para>View your new graphs.</para>
			<orderedlist>
				<listitem>
					<para>Click on <guilabel>Device Tree</guilabel> in the <guilabel>Reporting</guilabel> menu.</para>
				</listitem>
				<listitem>
					<para>Click on the name of your group to expand it.</para>
				</listitem>
				<listitem>
					<para>Click on the graph icon beside your device (orange graphs mean there are graphs associated with this device, black means there are no graphs attached to this device.</para>
				</listitem>
				<listitem>
					<para><emphasis>You should now see graphs!</emphasis>  If you don't, you may need to wait for the gatherer to perform another cycle.</para>
				</listitem>
			</orderedlist>
		</listitem>
	</orderedlist>
</chapter>
</part>

<part id="featureguide">
<title>Feature Guide</title>
<chapter id="extauth">
	<title>External Authentication</title>
	<para>
	NetMRG handles authentication internally by default, checking passwords against 
	its own database.  It is possible for NetMRG to use other systems for username/password 
	authentication.  This is accomplished by handing off the authentication task to the HTTP server.
	</para>
	<note><para>
	You must still create accounts in NetMRG for each user when using external authentication in order
	to assign them permissions and rights.
	</para></note>
	<para>
	Details on methods of authentication using the <ulink url="http://www.apache.org/"><application>Apache</application>
	 web server</ulink> are available <ulink url="http://httpd.apache.org/docs-2.0/howto/auth.html">here</ulink>.  
	There are add-on modules for <application>Apache</application> that allow for various authentication mechanisms, 
	including LDAP and custom database authentication systems.  Using <application>Apache</application>-based 
	authentication, it is possible for an organization to maintain users and passwords in one location for a variety
	of web-based services, only needing to set up application-specific permissions in each application.
	</para>
	<para>
	To enable external authentication, edit <filename>netmrg.xml</filename> and set 
	<computeroutput>externalAuth</computeroutput> to <userinput>true</userinput>.
	</para>
</chapter>
<chapter id="highlight">
	<title>Workday Highlighting</title>
	<para>Shading specific time periods on a graph is possible using <application>NetMRG</application>.  Typically this is used for highlighting
			the workday or SLA distinctions based on time of day.  The following steps will walk you through the setup
			of workday highlighting on a graph.
	</para>
	<orderedlist>
		<listitem><para>Add a new Graph Item.</para></listitem>
		<listitem><para>Select <guilabel>Show Advanced</guilabel>.</para></listitem>
		<listitem><para>Leave the title of the item blank if you want it to be omitted on the legend, otherwise enter a label such as "Business Hours."</para></listitem>
		<listitem><para>Set the <guilabel>Item Type</guilabel> to <guilabel>Area</guilabel>.</para></listitem>
		<listitem><para>Select a color for the highlighting.</para></listitem>
		<listitem><para>Select <guilabel>Fixed Value</guilabel> in the <guilabel>Monitor</guilabel> drop-down.</para></listitem>
		<listitem><para>Type in "INF" as the fixed value.  This allows the graph item to take on an infinite height, which is rendered by filling the background.</para></listitem>
		<listitem><para>Unselect all checkboxes under <guilabel>Legend</guilabel>.</para></listitem>
		<listitem><para>Enter start and stop times in their respective text boxes.  Times should be prefixed with a plus
		sign ('+') and be consistent with <ulink url="http://www.gnu.org/software/tar/manual/html_chapter/tar_7.html">GNU Date Input Formats</ulink>.
		An example would be <computeroutput>+9am</computeroutput> for a start time and <computeroutput>+5pm</computeroutput> 
		for an end time, to highlight the "typical" business day.</para></listitem>
		<listitem><para>Click <guilabel>Save Changes</guilabel> and observe the colored rectangle cover a lot of the data on your graph.</para></listitem>
		<listitem><para>Click <guilabel>Move Up</guilabel> beside your new graph item until it reaches the top of the list.  
		<emphasis>You now have a graph with workday highlighting!</emphasis></para></listitem>
	</orderedlist>
</chapter>
</part>

<part id="reference">
<title>Reference</title>
<reference id="manpage">
	<title>Manual Pages</title>
	
	<refentry id="netmrg-gatherer">
		<refmeta>
			<refentrytitle>netmrg-gatherer</refentrytitle>
			<manvolnum>1</manvolnum>
		</refmeta>
		<refnamediv>
			<refname>netmrg-gatherer</refname>
			<refpurpose>Gathers data from devices.</refpurpose>
		</refnamediv>
		<refsynopsisdiv>
			<cmdsynopsis>
				<command>/usr/local/bin/netmrg-gatherer</command>
				<arg choice="opt">OPTIONS</arg>
			</cmdsynopsis>
		</refsynopsisdiv>
		<refsect1><title>Description</title>
			<para>
				<command>netmrg-gatherer</command> performs tests on all enabled hosts in NetMRG.  It will store results in RRD files using RRDTOOL(1) and perform actions in response to events.
			</para>
			<variablelist>
				<title>Global Options</title>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-h</option></arg></cmdsynopsis></term>
					<listitem><para>Displays usage information and exits.</para></listitem>
				</varlistentry>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-v</option></arg></cmdsynopsis></term>
					<listitem><para>Displays software version and exits.</para></listitem>
				</varlistentry>
			</variablelist>
			<variablelist>
				<title>Operating Options</title>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-t</option> <replaceable>num threads</replaceable></arg></cmdsynopsis></term>
					<listitem><para>Run no more than the specified number of threads simultaneously.</para></listitem>
				</varlistentry>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-X</option></arg></cmdsynopsis></term>
					<listitem><para>Become a daemon.</para></listitem>
				</varlistentry>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-M</option> <replaceable>mode</replaceable></arg></cmdsynopsis></term>
					<listitem><para>Mode of operation.  This option controls the manner in which the gatherer operates.  The modes currently supported are "once" (the default, best used manually or via cron) which runs all tests once then exits, and "wait" (best used when daemonized) which will run all tests, wait for the gatherer interval to expire, and then repeat.</para></listitem>
				</varlistentry>
			</variablelist>
			<note><para>To run <application>netmrg-gatherer</application> daemonized, the recommended set of options at this point is "-X -S -M wait" which will daemonize, repeat the gather cycle on each interval, and write output to syslog.</para></note>
			<variablelist>
				<title>Logging, Debugging and Verbosity Options</title>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-S</option></arg></cmdsynopsis></term>
					<listitem><para>Syslog.  Logs messages to syslog instead of stdout.</para></listitem>
				</varlistentry>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-b</option></arg></cmdsynopsis></term>
					<listitem><para>Bland.  Disables color output.  By default, <application>netmrg-gatherer</application> will display color output when connected to a terminal, but will use bland output when its output is written to a file.  This option should only be needed when the detection mechanism has failed, or the user doesn't want to see colors when running the program by hand.</para></listitem>
				</varlistentry>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-a</option></arg></cmdsynopsis></term>
					<listitem><para>All.  Displays all log messages.</para></listitem>
				</varlistentry>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-m</option></arg></cmdsynopsis></term>
					<listitem><para>Most.  Displays more messages than default.</para></listitem>
				</varlistentry>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-q</option></arg></cmdsynopsis></term>
					<listitem><para>Quiet.  Silences all output.</para></listitem>
				</varlistentry>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-l</option> <replaceable>level mask</replaceable></arg></cmdsynopsis></term>
					<listitem><para>Only outputs messages that match the specified level mask.</para></listitem>
				</varlistentry>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-c</option> <replaceable>component mask</replaceable></arg></cmdsynopsis></term>
					<listitem><para>Only outputs messages that match the specified component mask.</para></listitem>
				</varlistentry>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-s</option></arg></cmdsynopsis></term>
					<listitem><para>Safe.  Tries to keep sensitive information out of the displayed messages.</para></listitem>
				</varlistentry>
			</variablelist>
			<variablelist>
				<title>Configuration File Options</title>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-C</option> <replaceable>config file</replaceable></arg></cmdsynopsis></term>
					<listitem><para>Uses the specified XML configuration file.</para></listitem>
				</varlistentry>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-K</option> <replaceable>config file</replaceable></arg></cmdsynopsis></term>
					<listitem><para>Parses the specified XML configuration file and exits.</para></listitem>
				</varlistentry>
			</variablelist>
			<variablelist>
				<title>Database Options</title>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-H</option> <replaceable>host</replaceable></arg></cmdsynopsis></term>
					<listitem><para>Uses the specified host name for connecting to the database.</para></listitem>
				</varlistentry>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-D</option> <replaceable>database</replaceable></arg></cmdsynopsis></term>
					<listitem><para>Uses the specified database name.</para></listitem>
				</varlistentry>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-u</option> <replaceable>user name</replaceable></arg></cmdsynopsis></term>
					<listitem><para>Uses the specified user name for connecting to the database.</para></listitem>
				</varlistentry>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-p</option> <arg choice="opt"><replaceable>password</replaceable></arg></arg></cmdsynopsis></term>
					<listitem><para>Uses the specified password for connecting to the database.  If no password is specified, the user is prompted to enter one.</para></listitem>
				</varlistentry>
			</variablelist>
			<variablelist>
				<title>Recaching Options</title>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-i</option> <replaceable>device id</replaceable></arg></cmdsynopsis></term>
					<listitem><para>Performs an interface recache on the specified device.</para></listitem>
				</varlistentry>
				<varlistentry>
					<term><cmdsynopsis><arg choice="plain"><option>-d</option> <replaceable>device id</replaceable></arg></cmdsynopsis></term>
					<listitem><para>Performs a disk recache on the specified device.</para></listitem>
				</varlistentry>
			</variablelist>
			<note><para>Recaching options are intended for use by the web interface.  These options should not be generally used by end users.</para></note>
		</refsect1>
	</refentry>
</reference>
<reference id="webpagedesc">
	<title>Web Interface Descriptions</title>
	<refentry id="Monitoring">
		<refmeta>
			<refentrytitle>Monitoring</refentrytitle>
		</refmeta>
		<refnamediv>
			<refname>Monitoring</refname>
			<refpurpose>Items associated with setting up gathering of information</refpurpose>
		</refnamediv>
		<refsect1><title>Description</title>
			<refsect2><title>Groups</title>
				<para>Management of <guilabel>Groups</guilabel>, Devices, Sub-devices, Monitors, Events, and the Notifications used by the events.</para>
			</refsect2>
			<refsect2><title>Device Types</title>
				<para>Types of devices; unused at this point.</para>
			</refsect2>
			<refsect2><title>Notifications</title>
				<para>Types of notifications that can be tied to events.</para>
				<itemizedlist>
					<listitem><para><userinput>Name</userinput> - Descriptive name of the notification</para></listitem>
					<listitem><para><userinput>Command</userinput> - Command to execute for the notification.  Notifications that start with a '/' will use the ful path the the specified command, whereas commands without a starting '/' will start using NetMRG's libexec directory.  Parameter substitution is fully functional here, as well.</para></listitem>
				</itemizedlist>
			</refsect2>
		</refsect1>
	</refentry>
	<refentry id="Groups">
		<refmeta>
			<refentrytitle>Groups</refentrytitle>
		</refmeta>
		<refnamediv>
			<refname>Groups</refname>
			<refpurpose>A container for a collection of devices</refpurpose>
		</refnamediv>
		<refsect1><title>Description</title>
			<refsect2><title>List</title>
				<para>List of all groups.  This is the default view when
				you first click on <guilabel>Groups</guilabel> in the nav bar.</para>
				<itemizedlist>
					<listitem><para><guilabel>Name</guilabel> - click on the name of the group to view the devices contained in it</para></listitem>
					<listitem><para><guilabel>Comments</guilabel> - description of a group</para></listitem>
					<listitem><para><guilabel>Add</guilabel> - add another group</para></listitem>
					<listitem><para><guilabel>View</guilabel> - views graphs assocated with this group and allows you to edit what graphs are associated with the group</para></listitem>
					<listitem><para><guilabel>Edit</guilabel> - edits parameters of a group</para></listitem>
					<listitem><para><guilabel>Delete</guilabel> - deletes the group and all devices, sub-devices, etc underneath it</para></listitem>
				</itemizedlist>
			</refsect2>
			<refsect2><title>Edit</title>
				<para>Edit information about a group</para>
				<itemizedlist>
					<listitem><para><userinput>Name</userinput> - Name of the group</para></listitem>
					<listitem><para><userinput>Comment</userinput> - Description of the group</para></listitem>
					<listitem><para><userinput>Parent</userinput> - Parent group for this group; sets up subgroups</para></listitem>
				</itemizedlist>
			</refsect2>
		</refsect1>
	</refentry>
	<refentry id="Devices">
		<refmeta>
			<refentrytitle>Devices</refentrytitle>
		</refmeta>
		<refnamediv>
			<refname>Devices</refname>
			<refpurpose>A container for a collection of sub-devices</refpurpose>
		</refnamediv>
		<refsect1><title>Description</title>
			<refsect2><title>List</title>
				<para>List of devices in a group; this is the default view when you click on a group name.</para>
				<itemizedlist>
					<listitem><para><guilabel>Name</guilabel> - click on the name of the device to view the sub devices contained in it</para></listitem>
					<listitem>
						<para><guilabel>SNMP Options</guilabel></para>
						<itemizedlist>
							<listitem><para><guilabel>View Interface Cache</guilabel> - views a list of cached interfaces (interfaces and values that NetMRG knows about)</para></listitem>
							<listitem><para><guilabel>Recache Interfaces</guilabel> - recache the interface list (to get new ifAliases or new interfaces, for example)</para></listitem>
							<listitem><para><guilabel>View Disk Cache</guilabel> - views a list of cached disks (disks and their values that NetMRG knows about)</para></listitem>
							<listitem><para><guilabel>Recache Disks</guilabel> - recache the list of disks (to get new disks or paths, for example)</para></listitem>
						</itemizedlist>
					</listitem>
					<listitem><para><guilabel>Add</guilabel> - add a new device or an existing device to this group</para></listitem>
					<listitem><para><guilabel>View</guilabel> - views graphs assocated with this device and allows you to edit what graphs are associated with the device</para></listitem>
					<listitem><para><guilabel>Edit</guilabel> - edits parameters of a device</para></listitem>
					<listitem><para><guilabel>Delete</guilabel> - deletes the device all sub-devices, monitors, etc underneath it</para></listitem>
				</itemizedlist>
			</refsect2>
			<refsect2><title>Add</title>
				<itemizedlist>
					<listitem><para><guilabel>Create a new device</guilabel> - creates a new device in the current group</para></listitem>
					<listitem>
						<para><guilabel>Add an existing device to this group</guilabel> - puts a link to an existing device in this group (does not copy it, just refers to it; they are the same device</para>
						<itemizedlist>
							<listitem><para><guilabel>Device</guilabel> - Name of the device to add to this group</para></listitem>
						</itemizedlist>
					</listitem>
				</itemizedlist>
			</refsect2>
			<refsect2><title>Edit</title>
				<para>Edit info about a device</para>
				<itemizedlist>
					<listitem><para><guilabel>General</guilabel></para>
						<itemizedlist>
							<listitem><para><guilabel>Name</guilabel> - Name of a device; commonly the hostname</para></listitem>
							<listitem><para><guilabel>IP or Hostname</guilabel> - IP address of the device, or hostname (must be resolvable by the monitoring box)</para></listitem>
							<listitem><para><guilabel>Device Type</guilabel> - Type of device (currently not used)</para></listitem>
							<listitem><para><guilabel>Disabled</guilabel> - Don't gather data for this device</para></listitem>
						</itemizedlist>
					</listitem>
					<listitem><para><guilabel>SNMP</guilabel></para>
						<itemizedlist>
							<listitem><para><guilabel>SNMP Support</guilabel> - The version of SNMP to use when querying this device, if any.</para></listitem>
							<listitem><para><guilabel>SNMP Read Community</guilabel> - The SNMP community string to use when querying this device.</para></listitem>
							<listitem><para><guilabel>Recaching Method</guilabel> - Methods used by the gatherer for determining if its SNMP cache is stale.</para>
								<itemizedlist>
									<listitem><para><guilabel>Never refresh cache</guilabel> - The gatherer will never automatically refresh the cache.  The cache must be refreshed manually when changes occur.</para></listitem>
									<listitem><para><guilabel>Refresh on SNMP agent restart</guilabel> - The gatherer will refresh the cache if the SNMP agent uptime goes backwards, or if the device has become reachable again after a period of unreachability.  This option is useful for devices that change interface counts too often, such as a router serving DSL sessions.</para></listitem>
									<listitem><para><guilabel>Refresh on interface count change</guilabel> - The gatherer will refresh the cache if the "ifNumber" value has changed since the last gathering.  This typically happens when cards are added to or removed from a router, or when PPP sessions go up or down.  (Also includes the above.)</para></listitem>
									<listitem><para><guilabel>Refresh on interface count mismatch</guilabel> - The gatherer will refresh the cache when the number of items in the interface cache do not match the "ifNumber" on a device.  This can prevent problems when devices are in the process of booting.  This is the preferred option for most devices. (Also includes the above.)</para></listitem>
									<listitem><para><guilabel>Always refresh cache</guilabel> - Always refresh the cache on each gather.  This is useful for devices that are always changing, when you care about the changes.</para></listitem>
								</itemizedlist>
							</listitem>
						</itemizedlist>
					</listitem>
					<listitem><para><guilabel>Advanced SNMP Options</guilabel></para>
						<itemizedlist>
							<listitem><para><guilabel>Disable SNMP Uptime Check</guilabel> - Allows NetMRG to work with devices that are broken or abnormal with respect to system.sysUpTime.0.  NetMRG usually uses this value to determine if a host is up and if the SNMP agent has restarted since the last polling cycle.  It should only be used when absolutely necessary as it reduces the robustness of the SNMP avoidance and recaching mechanisms which can be crutial to performance.</para></listitem>
							<listitem><para><guilabel>SNMP UDP Port</guilabel> - UDP port to direct SNMP queries to (default is 161).</para></listitem>
							<listitem><para><guilabel>SNMP Timeout (microseconds)</guilabel> - Number of microseconds to wait for a response to a query before retrying (default is 1000000 or 1 second).  An exponential backoff is used after each failed query; this is the initial delay.</para></listitem>
							<listitem><para><guilabel>SNMP Retries</guilabel> - Number of times to query the device before giving up (default is 3).</para></listitem>
						</itemizedlist>	
					</listitem>
				</itemizedlist>
			</refsect2>
			<refsect2><title>SNMP Cache View</title>
				<para>List of cached values for a device</para>
					<refsect3><title>Interface Cache</title>
						<para>List of Interfaces NetMRG knows about</para>
						<itemizedlist>
							<listitem><para><guilabel>Index</guilabel> - SNMP ifIndex</para></listitem>
							<listitem><para><guilabel>Status</guilabel> - SNMP ifAdminStatus/ifOperStatus</para></listitem>
							<listitem><para><guilabel>Name</guilabel> - SNMP ifName</para></listitem>
							<listitem><para><guilabel>Description</guilabel> - SNMP ifDescr</para></listitem>
							<listitem><para><guilabel>Alias</guilabel> - SNMP ifAlias (commonly the 'description' field on routers and switches)</para></listitem>
							<listitem><para><guilabel>IP Address</guilabel> - IP address of this interface</para></listitem>
							<listitem><para><guilabel>MAC Address</guilabel> - MAC address of this interface</para></listitem>
							<listitem><para><guilabel>View</guilabel> - View the graph for this interface (if monitored)</para></listitem>
							<listitem><para><guilabel>Monitors</guilabel> - View the monitors for this interface (if monitored)</para></listitem>
							<listitem><para><guilabel>Monitor/Graph</guilabel> - Choose to graph this interface (adds an interface subdevice based on ifDescr, adds monitors for ifInOctets, ifOutOctets, and ifInErrors for the subdevice, and assocates a graph with the device)</para></listitem>
						</itemizedlist>
					</refsect3>
					<refsect3><title>Disk Cache</title>
						<para>List of Disks NetMRG knows about</para>
						<itemizedlist>
							<listitem><para><guilabel>Index</guilabel> - SNMP dskIndex</para></listitem>
							<listitem><para><guilabel>Device</guilabel> - SNMP dskDevice</para></listitem>
							<listitem><para><guilabel>Path</guilabel> - SNMP dskPath</para></listitem>
							<listitem><para><guilabel>View</guilabel> - View the graph for this disk (if monitored)</para></listitem>
							<listitem><para><guilabel>Monitors</guilabel> - View the monitors for this disk (if monitored)</para></listitem>
							<listitem><para><guilabel>Monitor/Graph</guilabel> - Choose to graph this disk (adds a disk subdevice based on dskPath, adds monitors for KB Used and KB Available for the subdevice, and assocates a graph with the device)</para></listitem>
						</itemizedlist>
					</refsect3>
			</refsect2>
		</refsect1>
	</refentry>
	<refentry id="Sub-Devices">
		<refmeta>
			<refentrytitle>Sub Devices</refentrytitle>
		</refmeta>
		<refnamediv>
			<refname>Sub Devices</refname>
			<refpurpose>A container for a collection of monitors</refpurpose>
		</refnamediv>
		<refsect1><title>Description</title>
			<refsect2><title>List</title>
				<para>list of sub devices in a device</para>
				<itemizedlist>
					<listitem><para><guilabel>Sub Devices</guilabel> - Name of the sub devices for this device; click on a name to view its monitors</para></listitem>
					<listitem><para><guilabel>Type</guilabel> - Type of sub device (group, interface, or disk)</para></listitem>
					<listitem><para><guilabel>Add</guilabel> - add a new sub device to this device</para></listitem>
					<listitem><para><guilabel>Parameters</guilabel> - View/edit available parameters for this sub device (such as what ifName to use to graph this interface)</para></listitem>
					<listitem><para><guilabel>View</guilabel> - views graphs assocated with this sub device and allows you to edit what graphs are associated with the sub device</para></listitem>
					<listitem><para><guilabel>Edit</guilabel> - edits options of a sub device</para></listitem>
					<listitem><para><guilabel>Delete</guilabel> - deletes the sub device all monitors, events, etc underneath it</para></listitem>
				</itemizedlist>
			</refsect2>
			<refsect2><title>Edit</title>
				<para>edit info about a sub device</para>
				<itemizedlist>
					<listitem><para><guilabel>Name</guilabel> - Name of this sub device</para></listitem>
					<listitem><para><guilabel>Sub-Device Type</guilabel> - Type of sub device (group, interface, or disk)</para></listitem>
				</itemizedlist>
			</refsect2>
			<refsect2><title>Parameters</title>
				<para>items that alter what interface or disk a sub device monitors</para>
				<refsect3><title>Configured Parameters</title>
					<itemizedlist>
						<listitem><para><guilabel>Name</guilabel> - Name of paramter to match this sub device to (commonly 'dskPath' for disks or 'ifDescr' for interfaces)</para></listitem>
						<listitem><para><guilabel>Value</guilabel> - Value of the <guilabel>Name</guilabel> to match (commonly '/' for disks or 'eth0' for interfaces)</para></listitem>
						<listitem><para><guilabel>Add</guilabel> - Adds a Name/Value pair for this sub device</para></listitem>
						<listitem><para><guilabel>Edit</guilabel> - Edits the values above for this sub device</para></listitem>
						<listitem><para><guilabel>Delete</guilabel> - Deletes this Name/Value pair for this sub device</para></listitem>
					</itemizedlist>
				</refsect3>
				<refsect3><title>Dynamic Parameters</title>
					<itemizedlist>
						<listitem><para><guilabel>Name</guilabel> - Name of paramter that is available in template graphs as a wildcard (put between two '%' in the title)</para></listitem>
						<listitem><para><guilabel>Value</guilabel> - Value of the <guilabel>Name</guilabel> that will be displayed</para></listitem>
					</itemizedlist>
				</refsect3>
			</refsect2>
		</refsect1>
	</refentry>
	<refentry id="Monitors">
		<refmeta>
			<refentrytitle>Monitors</refentrytitle>
		</refmeta>
		<refnamediv>
			<refname>Monitors</refname>
			<refpurpose>A container for a collection of tracked values</refpurpose>
		</refnamediv>
		<refsect1><title>Description</title>
			<refsect2><title>List</title>
				<para>list of monitors for a sub-device</para>
				<itemizedlist>
					<listitem><para><guilabel>Test</guilabel> - Name of what is being monitored; click to view/edit events for this monitor</para></listitem>
					<listitem>
						<para><guilabel>Data</guilabel> - Information about the last gather of this monitor</para>
						<itemizedlist>
							<listitem><para><guilabel>Value</guilabel> - value gathered in the last run</para></listitem>
							<listitem><para><guilabel>Rate of Change</guilabel> - Difference between the current value and the last value, divided by the time between samples</para></listitem>
							<listitem><para><guilabel>Time Stamp</guilabel> - Date/Time of last gather for this monitor</para></listitem>
						</itemizedlist>
					</listitem>
					<listitem><para><guilabel>Graph</guilabel> - A small representation of the current data gathered for this monitor; click on the graph for more options</para></listitem>
					<listitem><para><guilabel>Add</guilabel> - add a new monitor to this sub device</para></listitem>
					<listitem><para><guilabel>Edit</guilabel> - edits options of a monitor</para></listitem>
					<listitem><para><guilabel>Delete</guilabel> - deletes the monitor and everything underneath it</para></listitem>
				</itemizedlist>
			</refsect2>
			<refsect2><title>Edit</title>
				<para>edit info about a monitor</para>
				<itemizedlist>
					<listitem><para><guilabel>Monitoring Type</guilabel> - specifies the type of test used for this monitor (Script, SNMP, SQL, or Internal)</para></listitem>
					<listitem><para><guilabel>Test Options</guilabel> - this section varies depending on the setting of <guilabel>Monitoring Type</guilabel></para>
						<itemizedlist>
							<listitem><para><guilabel>Script Options</guilabel></para>
								<itemizedlist>
									<listitem><para><guilabel>Script Test</guilabel> - specifies which script to run</para></listitem>
									<listitem><para><guilabel>Parameters</guilabel> - specifies a string which will be appended to the script's parameters.  Parameter expansions are honored in this field.</para></listitem>
								</itemizedlist>
							</listitem>
							<listitem><para><guilabel>SNMP Options</guilabel></para>
								<itemizedlist>
									<listitem><para><guilabel>SNMP Test</guilabel> - specifies which SNMP test to run</para></listitem>
									<listitem><para><guilabel>Parameters</guilabel> - specifies a string which will replace the expansion <computeroutput>%parameters%</computeroutput> in SNMP OIDs.</para></listitem>
								</itemizedlist>
							</listitem>
							<listitem><para><guilabel>SQL Options</guilabel></para>
								<itemizedlist>
									<listitem><para><guilabel>SQL Test</guilabel> - specifies which SQL test to run</para></listitem>
									<listitem><para><guilabel>Parameters</guilabel> - specifies a string which will replace the expansion <computeroutput>%parameters%</computeroutput> in SQL queries.</para></listitem>
								</itemizedlist>
							</listitem>
							<listitem><para><guilabel>Internal Options</guilabel></para>
								<itemizedlist>
									<listitem><para><guilabel>Internal Test</guilabel> - specifies which internal test to run</para></listitem>
									<listitem><para><guilabel>Parameters</guilabel> - specifies a string used by the internal test</para></listitem>
								</itemizedlist>
							</listitem>
						</itemizedlist>
						</listitem>
						<listitem><para><guilabel>Graphing Options</guilabel></para>
							<itemizedlist>
								<listitem><para><guilabel>Data Type</guilabel> - the <application>RRDTOOL</application> data type for this monitor</para>
									<itemizedlist>
										<listitem><para><guilabel>Absolute</guilabel> - a counter reset when read</para></listitem>
										<listitem><para><guilabel>Counter</guilabel> - an incrementing value interpreted as a rate (such as calculating your average speed with odometer readings)</para></listitem>
										<listitem><para><guilabel>Derive</guilabel> - a counter without overflow protection, permits graphing of negative rates</para></listitem>
										<listitem><para><guilabel>Gauge</guilabel> - the value read is the value used, such as temperatures</para></listitem>
									</itemizedlist>	
									<para>For a more complete discussion on when to use which data type, see the <ulink url="http://people.ee.ethz.ch/~oetiker/webtools/rrdtool/manual/rrdcreate.html">RRD Create manual page</ulink>.</para>
								</listitem>
								<listitem><para><guilabel>Minimum Value</guilabel> - the minimum value accepted by <application>RRDTOOL</application> as valid.</para></listitem>
								<listitem><para><guilabel>Maximum Value</guilabel> - the maximum value accepted by <application>RRDTOOL</application> as valid.</para></listitem>
							</itemizedlist>
						</listitem>
					
				</itemizedlist>
			</refsect2>
		</refsect1>
	</refentry>
	<refentry id="Events">
		<refmeta>
			<refentrytitle>Events</refentrytitle>
		</refmeta>
		<refnamediv>
			<refname>Events</refname>
			<refpurpose>A container for a collection of actions to take based on monitor values</refpurpose>
		</refnamediv>
		<refsect1><title>Description</title>
			<refsect2><title>List</title>
				<para>list of events for a monitor</para>
				<note><para>Events displayed in bold are currently triggered.</para></note>
			</refsect2>
			<refsect2><title>Edit</title>
				<para>edit info about an event</para>
				<itemizedlist>
					<listitem><para><guilabel>Name</guilabel> - a name for the event, unique within a device.  This name is used when displaying entries in the Event Log.</para></listitem>
					<listitem><para><guilabel>Trigger Type</guilabel> - when to trigger an event.  When events are triggered, they are logged in the Event Log and any Responses associated with the event are executed.</para>
						<itemizedlist>
							<listitem><para><guilabel>On Change</guilabel> - The event is triggered when its conditions are met, and the conditions had not been met on the last run.  Example:  If you have an event to warn you when CPU Usage climbs above 80%, it will trigger this condition if the previous value was 72 and the current value 85, but not if the previous value was 82 and the current value 85.  This prevents duplicate triggerings to a situation spanning multiple polling intervals.</para></listitem>
							<listitem><para><guilabel>Never (disabled)</guilabel> - This event is ignored and responses for it are not processed.</para></listitem>
						</itemizedlist>
						</listitem>
					<listitem><para><guilabel>Situation</guilabel> - the severity of the situation the event indicates.</para>
						<itemizedlist>
							<listitem><para><guilabel>Disabled</guilabel> - the tested service is in a non-operational, yet normal, condition.</para></listitem>
							<listitem><para><guilabel>Normal</guilabel> - the tested service is operating normally.</para></listitem>
							<listitem><para><guilabel>Warning</guilabel> - the tested service is operating in a degraded condition.</para></listitem>
							<listitem><para><guilabel>Critical</guilabel> - the tested service is not operating acceptably.</para></listitem>
						</itemizedlist>
						<note>
							<para>Situations for an event propagate up the Device Tree.  Each level takes on the worst situation of its descendents.  For example, if you have a <guilabel>Critical</guilabel> situation, the Event as well as the Monitor, Sub-Device, Device, and Groups above that Event will take on the situation <guilabel>Critical</guilabel> as well.</para>
						</note>
						</listitem>
				</itemizedlist>
			</refsect2>
		</refsect1>
	</refentry>
	<refentry id="Conditions">
		<refmeta>
			<refentrytitle>Conditions</refentrytitle>
		</refmeta>
		<refnamediv>
			<refname>Conditions</refname>
			<refpurpose>A collection of paramenters to trigger an Event</refpurpose>
		</refnamediv>
		<refsect1><title>Description</title>
			<refsect2><title>List</title>
				<para>list of conditions for an event</para>
			</refsect2>
			<refsect2><title>Edit</title>
				<para>edit info about an condition</para>
				<itemizedlist>
					<listitem><para><guilabel>Logical Operation</guilabel> - the logical operator (<guilabel>AND</guilabel> or <guilabel>OR</guilabel>) to apply between this condition and the previous one.  This parameter is not valid, nor is displayed, for the first condition in a set of conditions.</para></listitem>
					<listitem><para><guilabel>Value Type</guilabel> - the type of data about the Monitor to be used for comparision.</para>
						<itemizedlist>
							<listitem><para><guilabel>Current Value</guilabel> - the current value of the Monitor</para></listitem>
							<listitem><para><guilabel>Delta Value</guilabel> - the difference between the current value and the previous value.</para></listitem>
							<listitem><para><guilabel>Rate of Change</guilabel> - the delta value divided by the difference in timestamps between the current and previous values.  When using counters, this gives you the "per second" value.</para></listitem>
						</itemizedlist>
						</listitem>
					<listitem><para><guilabel>Condition</guilabel> - the arithmetic operator to use when comparing the <guilabel>Value Type</guilabel> of the Monitor and the <guilabel>Value</guilabel> of the Condition.</para></listitem>
					<listitem><para><guilabel>Value</guilabel> - the number used for comparision.</para></listitem>
				</itemizedlist>
			</refsect2>
		</refsect1>
	</refentry>
	<refentry id="Reporting">
		<refmeta>
			<refentrytitle>Reporting</refentrytitle>
		</refmeta>
		<refnamediv>
			<refname>Reporting</refname>
			<refpurpose>Items whose purpose is to display and report information to the user.</refpurpose>
		</refnamediv>
		<refsect1><title>Description</title>
			<refsect2><title>Device Tree</title>
				<para>Displays graphs attached to Groups, Devices, etc, down to the monitor level.  Graph icons next to each level represent where views are attached to items.  Orange icons mean one or more graphs are linked here; grey icons mean there are non currently.</para>
				<para>Groups will have a Slide Show icon next to them which will show all views in subgroups and devices underneath this group.</para>
				<para>Most items will also have a pencil icon (when a user has Read/Write permissions) in order to quickly edit this item.</para>
			</refsect2>
			<refsect2><title>Event Log</title>
				<para>When events are triggered, the record of their status changes can be viewed here.</para>
			</refsect2>
			<refsect2><title>Slide Show</title>
				<para>Starts an in-order or random slide show of all views.  A 'Resume Slide Show' link will also appear to go back to the place where you left off if you leave the slide show.  If you have auto-scroll enabled, clicking anywhere on the page will pause the slideshow, and clicking again will resume scrolling.</para>
			</refsect2>
		</refsect1>
	</refentry>
	<refentry id="Graphing">
		<refmeta>
			<refentrytitle>Graphing</refentrytitle>
		</refmeta>
		<refnamediv>
			<refname>Graphing</refname>
			<refpurpose>Where graphs (compositions of one or more monitors) are created.</refpurpose>
		</refnamediv>
		<refsect1><title>Description</title>
			<refsect2><title>Custom Graphs</title>
				<para>Custom Graphs are graphs meant to only be used once.  If you have an application where you are going to apply the same type of monitors to more than one device (even if the parameters are different), use a template graph.</para>
			</refsect2>
			<refsect2><title>Template Graphs</title>
				<para>Graphs intended to be used more than once.  Template graphs are applied to a sub-device at the view level.  It will look for the same type of monitors as it was created with and use the matching monitor types from whichever sub-device was selected.</para>
				<para>Template graphs also have the added benefit of being applied to a sub-device, allowing you to automatically create the same monitor types inside a new sub-device, quickly adding more monitors to your device.</para>
			</refsect2>
		</refsect1>
	</refentry>
	<refentry id="Tests">
		<refmeta>
			<refentrytitle>Tests</refentrytitle>
		</refmeta>
		<refnamediv>
			<refname>Tests</refname>
			<refpurpose>Tests represent actions taken to gather data.</refpurpose>
		</refnamediv>
		<refsect1><title>Overview</title>
			<para>A monitor can be thought of as a specific instantiation of a test.  There are currently four types of tests supported by <application>NetMRG</application>: Scripts, SNMP, SQL, and Internal.</para>
		</refsect1>
		<refsect1><title>Scripts</title>
			<para>Arbitrary scripts can be executed and their output or return values used as values to be monitored.</para>
			<refsect2><title>Edit</title>
			<itemizedlist>
			<listitem><para><guilabel>Name</guilabel> - An description used to identify the test.</para></listitem>
			<listitem><para><guilabel>Command</guilabel> - The program to execute for this test.  If the value of this field does not start with a slash, it is assumed that the command is located in the default NetMRG tests directory.  Commands are passed to a shell for execution by the gatherer.</para></listitem>
			<listitem><para><guilabel>Data Type</guilabel> - The type of data gathered from the program.
				<itemizedlist>
					<listitem><para><guilabel>Standard Out</guilabel> - Data from the program's standard output is returned.  The program should output data on one line which should be a numeric value or "U" to specify an unknown value.</para></listitem>
					<listitem><para><guilabel>Error Code</guilabel> - The integer return code from the executed program is returned.</para></listitem>
				</itemizedlist></para></listitem>
			</itemizedlist>
			</refsect2>
		</refsect1>
		<refsect1><title>SNMP</title>
			<para>SNMP (Simple Network Management Protocol) is widely used for accessing statistics on network infrastructure and hosts.</para>
			<refsect2><title>Edit</title>
			<itemizedlist>
				<listitem><para><guilabel>Name</guilabel> - An description used to identify the test.</para></listitem>
				<listitem><para><guilabel>SNMP OID</guilabel> - The OID to be obtained.  The value may be numeric or of any form your Net-SNMP library can understand.  Because the installed MIBs can vary from machine to machine, use of numeric (or at least common) values is preferred.</para></listitem>
				<listitem><para><guilabel>Type</guilabel> - specifies whether to GET or WALK the OID
				<itemizedlist>
					<listitem><para><guilabel>Direct (Get)</guilabel> - The specific OID specified will be returned.</para></listitem>
					<listitem><para><guilabel>Nth Item (Walk)</guilabel> - The OID specified will be walked until the Nth item is encountered.  This item will be returned.</para></listitem>
				</itemizedlist></para></listitem>
				<listitem><para><guilabel>Item #</guilabel> - Specifies which item to return when doing an SNMP walk.  This option has no effect on SNMP GETs.</para>
				</listitem>
			</itemizedlist>
			</refsect2>
		</refsect1>
		<refsect1><title>SQL</title>
			<para>SQL (more specifically, MySQL) tests are useful when you have data that is otherwise in-accessable, or takes a long time to gather.  Rather than making the netmrg-gatherer run a script test that will take a long time, consider writing the script to run periodically (out of Cron, for example) and dumping its output into a MySQL database for NetMRG to gather later.  This greatly reduces NetMRG's runtime.</para>
			<refsect2><title>Edit</title>
			<itemizedlist>
				<listitem><para><guilabel>Name</guilabel> - An description used to identify the test.</para></listitem>
				<listitem><para><guilabel>Host</guilabel> - The host running the MySQL server you wish to connect to.</para></listitem>
				<listitem><para><guilabel>User</guilabel> - The MySQL user to connect as.</para></listitem>
				<listitem><para><guilabel>Password</guilabel> - The password for the MySQL user.</para></listitem>
				<listitem><para><guilabel>Query</guilabel> - The SQL query to perform.</para><note><para>No default database is specified, so be sure to include the database name in the table names that you use in your query.</para></note></listitem>
				<listitem><para><guilabel>Column Number</guilabel> - The column to return.  NetMRG will collect the value from this column in the first row of the result set.</para></listitem>
			</itemizedlist>
			</refsect2>
		</refsect1>
		<refsect1><title>Internal</title>
		<para>Internal tests are compiled into the gatherer.  These tests typically start as script tests, and are then migrated to the gatherer for efficiency.  At the moment, the gatherer source code is the only documentation for such tests, however some are obvious.  The intention is to expand this category to include DSO-based test packages.</para>
		</refsect1>
	</refentry>
	<refentry id="Admin">
		<refmeta>
			<refentrytitle>Admin</refentrytitle>
		</refmeta>
		<refnamediv>
			<refname>Admin</refname>
			<refpurpose>Administrative functions not related to the reporting or gathering of information.</refpurpose>
		</refnamediv>
		<refsect1><title>Description</title>
			<refsect2><title>Users</title>
				<para>The area where you manage users that are allowed to view or modify graphs and parameters in NetMRG.  If you're using External Auth, you will also need to come here to create users to setup permissions for them to access your NetMRG installation.</para>
			</refsect2>
			<refsect2><title>Prefs</title>
				<para>Preferences for your users (such as auto-scroll in the Slide Show, or changing your password).  If you're an admin, you will be able to change your users' prefs here, or you will only be able to change your own.</para>
			</refsect2>
			<refsect2><title>Logout</title>
				<para>Logout of NetMRG.  NetMRG will keep its session active for 24 hours; this may allow other users to come and use your computer to view or modify your graphs if you don't close your browser.  Logging out of NetMRG will prevent accidental (or malevolent) activities in your NetMRG installation.</para>
			</refsect2>
		</refsect1>
	</refentry>
	<refentry id="Help">
		<refmeta>
			<refentrytitle>Help</refentrytitle>
		</refmeta>
		<refnamediv>
			<refname>Help</refname>
			<refpurpose>How to get assistance with NetMRG.</refpurpose>
		</refnamediv>
		<refsect1><title>Description</title>
			<refsect2><title>About</title>
				<para>Some basic information about NetMRG, its authors, the license, and credits to noteworthy contributors.</para>
			</refsect2>
			<refsect2><title>Manual</title>
				<para>A link to the NetMRG Manual.</para>
			</refsect2>
			<refsect2><title>Forum</title>
				<para>A link to the best place to go for useability questions.</para>
			</refsect2>
			<refsect2><title>Bugs</title>
				<para>If you think you have found a bug, submit it here.</para>
			</refsect2>
		</refsect1>
	</refentry>
</reference>
</part>

<chapter id="contact">
	<title>Contact Information</title>
	<para>We have great aspirations for what NetMRG could become, but as with all open-source software, such aspriations can only be achieved with the active participation of the open-source community.  Please do your part and support software that you use by helping to answer support questions on forums and report bugs to developers.  Thanks!</para>
	<itemizedlist>
		<listitem><para>Main Website - <ulink url="http://www.netmrg.net/">http://www.netmrg.net/</ulink></para></listitem>
		<listitem><para>Support Forum - <ulink url="http://lists.netmrg.net/">http://lists.netmrg.net/</ulink></para></listitem>
		<listitem><para>Bug Reporting and Tracking - <ulink url="http://bugs.netmrg.net/">http://bugs.netmrg.net/</ulink></para></listitem>
	</itemizedlist>
</chapter>
</book>
